
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.7">
    
    
      
        <title>进阶用法 - python-validator</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="python-validator" class="md-header-nav__button md-logo" aria-label="python-validator">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            python-validator
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              进阶用法
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ausaki/python-validator/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="python-validator" class="md-nav__button md-logo" aria-label="python-validator">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    python-validator
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ausaki/python-validator/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        首页
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          进阶用法
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        进阶用法
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#validator" class="md-nav__link">
    定义 Validator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    校验数据
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    错误信息
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    自定义字段级的校验方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    自定义全局的校验方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    生成测试数据
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_dict" class="md-nav__link">
    to_dict
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    数据结构字典
  </a>
  
    <nav class="md-nav" aria-label="数据结构字典">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    特殊字段
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validator_1" class="md-nav__link">
    通过数据结构字典创建 Validator
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../i18n/" class="md-nav__link">
        国际化
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        字段
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="字段" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          字段
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fields/" class="md-nav__link">
        字段 API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../custom_field/" class="md-nav__link">
        自定义字段
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        异常
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
      
      <label class="md-nav__link" for="nav-6">
        关于
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="关于" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          关于
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../history/" class="md-nav__link">
        历史版本
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        LICENSE
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#validator" class="md-nav__link">
    定义 Validator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    校验数据
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    错误信息
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    自定义字段级的校验方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    自定义全局的校验方法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    生成测试数据
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_dict" class="md-nav__link">
    to_dict
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    数据结构字典
  </a>
  
    <nav class="md-nav" aria-label="数据结构字典">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    特殊字段
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validator_1" class="md-nav__link">
    通过数据结构字典创建 Validator
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ausaki/python-validator/edit/master/docs/advanced.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="_1">进阶</h1>
<p>python-validator 主要包含 <code>Validator</code> 和 <code>XXXField</code> 两部分，<code>Validator</code> 类似于 Django 中的 Model，用于描述数据结构，其中的 <code>XXXField</code> 描述了字段的类型和约束并负责校验对应的数据。</p>
<hr />
<h2 id="validator">定义 Validator</h2>
<p>直接继承 <code>Validator</code> 类并列出包含的字段</p>
<pre><code class="language-python">from validator import Validator, StringField, IntegerField, EnumField

class UserInfoValidator(Validator):
    name = StringField(max_length=50, required=True)
    age = IntegerField(min_value=1, max_value=120, default=20)
    sex = EnumField(choices=['f', 'm'])
</code></pre>
<p>上面的代码定义了一个校验用户信息的 <code>Validator</code>:</p>
<ul>
<li>
<p>name 是一个字符串，最大长度为 50 个字节，并且必须提供不能缺失。注意这里的长度指的是字节，而不是字符。</p>
</li>
<li>
<p>age 是一个整形，最小值 1，最大值 120，非必须，默认值 20</p>
</li>
<li>
<p>sex 是一个枚举类型，可选值：['f', 'm']，非必须。</p>
</li>
</ul>
<p>当 <code>required</code> 为 <code>True</code> 时，该字段必须提供，除非显式指定 <code>default</code> 值。如果 <code>required</code> 为 <code>True</code> 且没有指定 <code>default</code> 值，当字段不存在时将会发生异常 <code>FieldValidationError</code>。以上面的 <code>UserInfoValidator</code> 为例，下面的数据将会发生异常：</p>
<pre><code class="language-python">data = {
    # 缺少 name 字段
    'age': 20,
    'sex': 'f'
}
</code></pre>
<p>python-validator 还支持 <a href="#validator_1">通过数据结构字典创建 Validator</a>。</p>
<p>关于字段参数请参考 <a href="../fields/">字段 API</a>。</p>
<hr />
<h2 id="_2">校验数据</h2>
<p>使用 <code>is_valid()</code> 校验数据，数据合法该方法返回 <code>True</code>，否则返回 <code>False</code>。</p>
<pre><code class="language-python">data = {
    'name:'Bob',
    'age': 30,
    'sex': 'm'
}
v = UserInfoValidator(data)
print(v.is_valid()) #  校验数据
print(v.validated_data) # 获取校验过的数据
</code></pre>
<p>如果数据不合法，那么 <code>v.validated_data</code> 是 None。</p>
<p><code>is_valid()</code> 其实还接受一个可选的参数 <code>raise_error</code>，该参数默认为 <code>False</code>，
如果 <code>raise_error</code> 为 <code>True</code>，那么当数据非法时，<code>is_valid()</code> 会触发异常 <code>ValidationError</code>，而不是返回 <code>False</code>。</p>
<hr />
<h2 id="_3">错误信息</h2>
<p>错误信息保存在实例属性 <code>errors</code> 中，<code>errors</code> 是一个字典，包含了每个错误字段的错误信息，例如：</p>
<pre><code class="language-python"># data
{
    'age': '24',
    'sex': 'f'
}
# v.errors
{
    'age': &lt;FieldValidationError: got a wrong type: str, expect integer&gt;,
    'name': &lt;FieldRequiredError: Field is required&gt;
}
</code></pre>
<p><code>str_errors</code> 属性是格式化之后的错误信息，例如：</p>
<pre><code class="language-python">{
    'age': 'got a wrong type: str, expect integer',
    'name': 'Field is required'
}
</code></pre>
<hr />
<h2 id="_4">自定义字段级的校验方法</h2>
<p><code>Validator</code> 在校验数据时会自动调用形如 <code>validate_xxx</code> 的方法校验字段数据。
<code>validate_xxx</code> 方法接受一个参数 <code>value</code>（已经校验过的值），无需返回任何值。如果数据非法，触发 <code>FieldValidationError</code> 异常即可。</p>
<blockquote>
<p>将 xxx 替换为字段名</p>
</blockquote>
<p>代码示例：</p>
<pre><code class="language-python">from validator import Validator, StringField, IntegerField, EnumField, FieldValidationError

class UserInfoValidator(Validator):
    name = StringField(max_length=50, required=True)
    age = IntegerField(min_value=1, max_value=120, default=20)
    sex = EnumField(choices=['f', 'm'])

    def validate_name(self, value):
        if value == 'foo':
            raise FieldValidationError('&quot;foo&quot; is invalid')
</code></pre>
<p><strong> 注意：不建议在 <code>validate_xxx</code> 方法中修改 <code>value</code></strong></p>
<hr />
<h2 id="_5">自定义全局的校验方法</h2>
<p>当校验完所有字段的数据后，<code>Validator</code> 会调用 <code>validate</code> 方法校验全局数据，此时的全局数据是一个已经校验过的 dict。默认的 <code>validate</code> 方法直接返回数据，你可以覆盖它以实现自己的校验逻辑。</p>
<p>代码示例：</p>
<pre><code class="language-python">from validator import Validator, StringField, IntegerField, EnumField, ValidationError

class UserInfoValidator(Validator):
    name = StringField(max_length=50, required=True)
    age = IntegerField(min_value=1, max_value=120, default=20)
    sex = EnumField(choices=['f', 'm'])

    def validate(self, data):
        if data['name'] == 'Bob' and data['age'] &gt; 60:
            raise ValidationError('Bob is too old, he is younger than 60 age')
        # 你也可以在这里修改 data 的数据
        # data['foo'] = 'bar'
        return data
</code></pre>
<hr />
<h2 id="_6">生成测试数据</h2>
<p>类方法 <code>mock_data()</code> 方法可以生成测试数据，该数据不保证完全通过校验，特别是通过 “自定义字段级的校验方法” 和 “自定义全局的校验方法” 的校验。</p>
<p>代码示例：</p>
<pre><code class="language-python">data = UserInfoValidator.mock_data()
print(data) # {'age': 74, 'name': u'R7fuZaWOCPUVeYSQqaUvI', 'sex': 'f'}
</code></pre>
<hr />
<h2 id="to_dict">to_dict</h2>
<p>类方法 <code>to_dict(cls)</code> 返回一个描述数据结构的 dict，例如：</p>
<pre><code class="language-python">{
    &quot;age&quot;: {
        &quot;required&quot;: false,
        &quot;default&quot;: 20,
        &quot;max_value&quot;: 120,
        &quot;min_value&quot;: 1,
        &quot;strict&quot;: true,
        &quot;validators&quot;: [],
        &quot;type&quot;: &quot;integer&quot;
    },
    &quot;name&quot;: {
        &quot;regex&quot;: null,
        &quot;min_length&quot;: 0,
        &quot;max_length&quot;: 50,
        &quot;strict&quot;: true,
        &quot;default&quot;: &quot;__empty__&quot;,
        &quot;validators&quot;: [],
        &quot;required&quot;: true,
        &quot;type&quot;: &quot;string&quot;
    },
    &quot;sex&quot;: {
        &quot;default&quot;: &quot;__empty__&quot;,
        &quot;required&quot;: false,
        &quot;choices&quot;: [
            &quot;f&quot;,
            &quot;m&quot;
        ],
        &quot;strict&quot;: true,
        &quot;validators&quot;: [],
        &quot;type&quot;: &quot;enum&quot;
    }
}
</code></pre>
<hr />
<h2 id="_7">数据结构字典</h2>
<p>数据结构字典的 key 是字段名称，value 是描述字段的类型和初始化参数的字典。</p>
<p>以上面 <code>to_dict</code> 返回的字典为例，<code>age</code>， <code>name</code>，和 <code>sex</code> 都是字段名称，其对应的值包含了字段类型和初始化参数。</p>
<p><code>type</code> 表示字符串形式的字段类型，每个字段的字符串形式的字段类型保存在 <code>FIELD_TYPE_NAME</code> 属性中。剩余的参数都是字段的初始化参数。</p>
<p>假如 <code>default</code> 等于 <code>EMPTY_VALUE</code>，为了方便则使用 <code>'__empty__'</code> 表示。</p>
<h3 id="_8">特殊字段</h3>
<ul>
<li>
<p>ListField</p>
<p>ListField 是复合数据，需要通过 <code>field</code> 参数指明列表项的类型，<code>field</code> 参数同样适用字典来表示。例如：</p>
</li>
</ul>
<pre><code class="language-python">class V(Validator):
    cards = ListField(min_length=1, max_length=52,
                    field=IntegerField(min_value=1, max_value=13))

print(json.dumps(V.to_dict(), indent=4))
# json output
{
    &quot;cards&quot;: {
        &quot;min_length&quot;: 1,
        &quot;strict&quot;: true,
        &quot;default&quot;: &quot;__empty__&quot;,
        &quot;required&quot;: false,
        &quot;field&quot;: {
            &quot;required&quot;: false,
            &quot;default&quot;: &quot;__empty__&quot;,
            &quot;max_value&quot;: 13,
            &quot;min_value&quot;: 1,
            &quot;strict&quot;: true,
            &quot;validators&quot;: [],
            &quot;type&quot;: &quot;integer&quot;
        },
        &quot;max_length&quot;: 52,
        &quot;validators&quot;: [],
        &quot;type&quot;: &quot;list&quot;
    }
}
</code></pre>
<ul>
<li>
<p>DictField</p>
<p>DictField 是复合数据，需要通过 <code>validator</code> 参数校验字典内部的各个字段。<code>validator</code> 就是 <code>Validator</code> 的实例，因此可以通过字典来描述 <code>validator</code>，就像一个 <code>validator</code> 嵌套了另外一个 <code>validator</code>。例如：</p>
</li>
</ul>
<pre><code class="language-python">data = {
    'rectangle': {
        'type': 'dict',
        'validator': {
            'width': {
                'type': 'integer',
                'default': '__empty__'
            },
            'height': {
                'type': 'integer',
            }
        },
    }
}
V = create_validator(data)
print(json.dumps(V.to_dict(), indent=4))
# output
{
    &quot;rectangle&quot;: {
        &quot;default&quot;: &quot;__empty__&quot;,
        &quot;required&quot;: false,
        &quot;strict&quot;: true,
        &quot;validator&quot;: {
            &quot;width&quot;: {
                &quot;required&quot;: false,
                &quot;default&quot;: &quot;__empty__&quot;,
                &quot;max_value&quot;: null,
                &quot;min_value&quot;: null,
                &quot;strict&quot;: true,
                &quot;validators&quot;: [],
                &quot;type&quot;: &quot;integer&quot;
            },
            &quot;height&quot;: {
                &quot;required&quot;: false,
                &quot;default&quot;: &quot;__empty__&quot;,
                &quot;max_value&quot;: null,
                &quot;min_value&quot;: null,
                &quot;strict&quot;: true,
                &quot;validators&quot;: [],
                &quot;type&quot;: &quot;integer&quot;
            }
        },
        &quot;validators&quot;: [],
        &quot;type&quot;: &quot;dict&quot;
    }
}
</code></pre>
<hr />
<h2 id="validator_1">通过数据结构字典创建 Validator</h2>
<p><code>create_validator(data_struct_dict, name=None)</code></p>
<p>根据 <code>data_struct_dict</code> 创建一个 Validator 实例。<code>data_struct_dict</code> 是一个描述数据结构的字典，类似于 <code>to_dict</code> 返回的字典。</p>
<p>示例：</p>
<pre><code class="language-python">data = {
    'name': {
        'type': 'string',
        'min_length': 10,
        'max_length': 20,
    }
}
V = create_validator(data)
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href=".." class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                首页
              </div>
            </div>
          </a>
        
        
          <a href="../i18n/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                国际化
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.53cc9318.min.js"></script>
      <script src="../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>